#!/bin/sh
# Script automatically applies gamma to reduce eye strain
# run every 10 minutes with crontab -e 
# */2 * * * * export DISPLAY=:0.0 && $HOME/.local/bin/autored

pkill gammastep
gammastep -x &
pkill gammastep
if [[ $1 != "" ]] then
    gammastep -PO $1
    exit
fi

current_hour=$(date +%H)
current_minute=$(date +%M)

[ -f /tmp/noautored ] && pkill gammastep && exit 0
set -x
case $current_hour in
    00|01|02|03|04|05|06)
        gammastep -PO 3000
        ;;
    07|08|09|10|11)
        pkill gammastep
        ;;
    12|13|14|15|16|17|18|19|20)
        pkill gammastep
        ;;
    21)
        (( current_minute < 30 )) && gammastep -PO 5500 || gammastep -PO 4700 ;;
    22)
        (( current_minute < 30 )) && gammastep -PO 4200 || gammastep -PO 3900 ;;
    23)
        (( current_minute < 30 )) && gammastep -PO 3800 || gammastep -PO 3500 ;;
    *)
        echo "Invalid hour!"
        exit 1
        ;;
esac
