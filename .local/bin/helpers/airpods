#!/bin/bash

device="00:F3:9F:6E:01:01"
dbus_device="/org/bluez/hci0/dev_${device//:/_}"

is_connected() {
    busctl get-property org.bluez "$dbus_device" org.bluez.Device1 Connected | grep -q "true"
}

if [ "${1-}" = "-s" ] || [ "${1-}" = "--status" ]; then
    if is_connected; then
        exit 1
    else
        exit 0
    fi
fi

if is_connected; then
    bluetoothctl disconnect "$device"
    echo "disconnected"
    exit 0
fi

bluetoothctl connect "$device"
echo "connected"
exit 1
